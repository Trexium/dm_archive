@page "/article/{id:int?}"
@using DungeonMastersArchive.Components.Article.Shared
@using DungeonMastersArchive.Models.Article
@using DungeonMastersArchive.Services

@inject IArticleService ArticleService
@inject IUserService UserService
@inject IImageService ImageService

@if (_model == null)
{

}
else
{
    // Karaktär
    @*     @if (false && _model.ArticleTypeId == "1" || _model.ArticleTypeId == "2" || _model.ArticleTypeId == "6")
    {

    }
    else if (false && _model.ArticleTypeId == "4")
    {

    }
    else
    { *@
    <MudStack>
        <MudPaper Class="flex-grow-1 pa-6 ma-2" Elevation="3">
            <MudStack>
                
                <MudText Typo="Typo.h2">@(!string.IsNullOrEmpty(_model.ArticleName) ? _model.ArticleName : _model.ArticleTypeDisplayText)</MudText>
                <ArticleImageCaruosel ArticleId="Id" />
                <br />
                <MudText Typo="Typo.body1">
                    @((MarkupString)_model.ArticleText)
                </MudText>
            </MudStack>
        </MudPaper>
        <MudPaper Class="pa-6 ma-2" Elevation="3">
            <LinksSection ArticleId="@Id" />
        </MudPaper>
        <MudPaper Class="pa-6 ma-2" Elevation="3">
            <MudText Typo="Typo.h6">Taggar</MudText>
            <br />
            @if (_model.Tags != null && _model.Tags.Any())
            {
                <MudChipSet T="string" Variant="Variant.Text" Color="Color.Info">
                    @foreach (var tag in _model.Tags)
                    {
                        <MudChip Value="@(tag.Tag)" />
                    }
                </MudChipSet>
            }
        </MudPaper>
    </MudStack>
    @* } *@

}



@code {
    [Parameter]
    public int Id { get; set; }

    private Models.Article.Article _model;
    private Models.User.User _user;



    protected override async Task OnInitializedAsync()
    {

    }

    protected override async Task OnParametersSetAsync()
    {
        _user = await UserService.GetCurrentUser();
        _model = await ArticleService.GetArticle(Id);
    }
}
